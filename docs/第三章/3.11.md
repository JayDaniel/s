
## 视频播放
在 Flutter 里官方提供了一个 [video_player](https://pub.flutter-io.cn/packages/video_player) 插件可以播放视频。

先安装依赖：

```js
dependencies:
  video_player: ^0.6.4
```

### 基本使用

```js
class _VideoAppState extends State<VideoApp> {
    VideoPlayerController _controller;
    bool _isPlaying = false;
    String url = 'http://vd3.bdstatic.com/mda-ifvq' +
                'u9yp3eaqueep/mda-ifvqu9yp3eaqueep.mp4';

    @override
    void initState() {
        super.initState();
        _controller = VideoPlayerController.network(this.url)
        // 播放状态
        ..addListener(() {
            final bool isPlaying = _controller.value.isPlaying;
            if (isPlaying != _isPlaying) {
                setState(() { _isPlaying = isPlaying; });
            }
        })
        // 在初始化完成后必须更新界面
        ..initialize().then((_) {
            setState(() {});
        });
    }

    @override
    Widget build(BuildContext context) {
        return MaterialApp(
            title: 'Video Demo',
            home: new Scaffold(
                body: new Center(
                child: _controller.value.initialized
                    // 加载成功
                    ? new AspectRatio(
                        aspectRatio: _controller.value.aspectRatio,
                        child: VideoPlayer(_controller),
                    ) : new Container(),
                ),
                floatingActionButton: new FloatingActionButton(
                    onPressed: _controller.value.isPlaying
                        ? _controller.pause
                        : _controller.play,
                    child: new Icon(
                        _controller.value.isPlaying ? Icons.pause : Icons.play_arrow,
                    ),
                ),
            ),
        );
    }
}
```

下面是在模拟器下看到的效果（略卡）。

![](/../../image/20180706120001.gif)

video_player 的 controller 有以下方法可用：
- **initialize()** - 初始化播放器。
- **dispose()** - 释放播放器资源。
- **notifyListeners()** - 监听播放消息。
- **addListener(listener)** - 添加监听器。
- **removeListener(listener)** - 移除监听器。
- **pause()** - 暂停播放。
- **play()** - 开始播放。
- **position** - 播放位置。
- **seekTo(moment)** - 指定到某个位置播放。
- **setLooping(looping)** - 是否循环播放。
- **setVolume(volume)** - 设置音量大小。

### 使用 chewie
[chewie](https://pub.flutter-io.cn/packages/chewie)，是一个非官方的第三方视频播放组件，看起来好像是基于 HTML5 播放的组件。chewie 相对 video_player 来说，有控制栏和全屏的功能。Chewie 使用 video_player 引擎并将其包裹在友好的 Material 或 Cupertino UI 中！

安装依赖：

```js
dependencies
  chewie: ^0.6.1
```

基本使用：

```js
import 'package:chewie/chewie.dart';

new Center(
    child: new Chewie(
        new VideoPlayerController.network(this.url),
        aspectRatio: 16 / 9,
        autoPlay: !true,
        looping: true,
        showControls: true,
        // 占位图
        placeholder: new Container(
            color: Colors.grey,
        ),

        // 是否在 UI 构建的时候就加载视频
        autoInitialize: !true,

        // 拖动条样式颜色
        materialProgressColors: new ChewieProgressColors(
            playedColor: Colors.red,
            handleColor: Colors.blue,
            backgroundColor: Colors.grey,
            bufferedColor: Colors.lightGreen,
        ),
    ),
),
```

![](/../../image/20180706173946.png)

chewie 实际上就是为 video_player 做了一个 UI 上的封装，因为 UI 实在长得太像，